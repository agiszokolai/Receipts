import{a as Ae}from"./chunk-VVQJYBMU.js";import{a as Le}from"./chunk-NHIW3AEF.js";import{E as D,G as Ie,H as De,a as ve,b as H,c as C,d as K,e as J,f as z,g as S,i as Q,j as we,m as W,n as he,o as ye,p as X,q as ke,r as Ee,s as Re,t as be,u as M,v as I,w as Te}from"./chunk-TMOWURAR.js";import{Ab as Oe,Ba as g,Cb as Ne,Da as _,Db as Me,Ea as a,Eb as $e,Fa as de,G as w,Ga as ue,Ha as d,Ia as F,J as P,Ja as h,K as p,L as m,O as N,Q as k,Ra as b,Sa as A,T as y,Wa as _e,X as q,Z as le,Za as fe,_ as l,a as re,cb as G,db as Ce,ea as V,eb as B,i as oe,ia as v,jb as T,m as se,ma as u,pb as ge,qa as x,rb as j,sa as O,ta as E,ua as R,ub as xe,v as L,va as o,vb as Se,wa as s,wb as Ve,x as ae,xa as f,xb as Fe,y as ce,ya as pe,yb as Y,za as me,zb as Ue}from"./chunk-TQGG3II2.js";var U=class{label;name;constructor(t,e){this.label=t,this.name=e}};var ze=r=>({active:r}),Pe=(r,t)=>({"fa-sort-up":r,"fa-sort-down":t}),Ge=r=>({"active-item":r});function Qe(r,t){if(r&1){let e=g();o(0,"div",42)(1,"div",45),f(2,"input",46),o(3,"label",47),d(4,"Szekci\xF3 neve:"),s()(),o(5,"i",48),_("click",function(){p(e);let n=a().$index,c=a(2);return m(c.removeSection(n))})("keyup",function(){p(e);let n=a().$index,c=a(2);return m(c.removeSection(n))}),s()()}}function We(r,t){if(r&1&&(o(0,"option",55),d(1),s()),r&2){let e=t.$implicit;u("value",e),l(),F(e)}}function Xe(r,t){if(r&1){let e=g();o(0,"div",11)(1,"div",49)(2,"div",6),f(3,"input",50),o(4,"label",51),d(5,"Hozz\xE1val\xF3:"),s()(),o(6,"div",6),f(7,"input",52),o(8,"label",53),d(9,"Mennyis\xE9g:"),s()(),o(10,"div",6)(11,"select",54),E(12,We,2,2,"option",55,O),s()(),o(14,"i",48),_("click",function(){let n=p(e).$index,c=a().$index,te=a(2);return m(te.removeIngredient(c,n))})("keyup",function(){let n=p(e).$index,c=a().$index,te=a(2);return m(te.removeIngredient(c,n))}),s()()()}if(r&2){let e=t.$index,i=a(3);u("formGroupName",e),l(12),R(i.unitEnum)}}function Ye(r,t){if(r&1){let e=g();o(0,"div",11),v(1,Qe,6,0,"div",42),o(2,"div",43),E(3,Xe,15,1,"div",11,O),o(5,"button",44),_("click",function(){let n=p(e).$index,c=a(2);return m(c.addIngredient(n))}),d(6,"+ Hozz\xE1val\xF3 hozz\xE1ad\xE1sa"),s()()()}if(r&2){let e=t.$implicit,i=t.$index,n=a(2);u("formGroupName",i),l(),x(e?1:-1),l(2),R(n.ingredients(i).controls)}}function Ze(r,t){if(r&1){let e=g();o(0,"div",12),f(1,"input",46),o(2,"label",47),d(3,"\xDAj szekci\xF3 neve:"),s(),o(4,"i",56),_("click",function(){p(e);let n=a(2);return m(n.addSection())})("keyup",function(){p(e);let n=a(2);return m(n.addSection())}),s()()}}function et(r,t){if(r&1){let e=g();o(0,"button",44),_("click",function(){p(e);let n=a(2);return m(n.showNewSectionInput=!0)}),d(1," + \xDAj szekci\xF3 hozz\xE1ad\xE1sa "),s()}}function tt(r,t){if(r&1){let e=g();o(0,"div",57)(1,"div",58),d(2),s(),o(3,"div",6),f(4,"textarea",59),o(5,"label",60),d(6,"Elk\xE9sz\xEDt\xE9si l\xE9p\xE9s"),s()(),o(7,"i",48),_("click",function(){let n=p(e).index,c=a(2);return m(c.removeStep(n))})("keyup",function(){let n=p(e).index,c=a(2);return m(c.removeStep(n))}),s()()}if(r&2){let e=t.index;u("formGroupName",e),l(2),h("",e+1,".")}}function it(r,t){if(r&1){let e=g();o(0,"li",62),_("click",function(){let n=p(e).$implicit,c=a(3);return m(c.selectDifficulty(n))})("keyup",function(){let n=p(e).$implicit,c=a(3);return m(c.selectDifficulty(n))}),d(1),s()}if(r&2){let e=t.$implicit,i=a(3);u("ngClass",b(2,Ge,i.selectedDifficulty===e)),l(),h(" ",e," ")}}function nt(r,t){if(r&1&&(o(0,"div",28)(1,"ul"),E(2,it,2,4,"li",61,O),s()()),r&2){let e=a(2);l(2),R(e.difficultyEnum)}}function rt(r,t){if(r&1){let e=g();o(0,"li",62),_("click",function(){let n=p(e).$implicit,c=a(4);return m(c.selectCategory(n))})("keyup",function(){let n=p(e).$implicit,c=a(4);return m(c.selectCategory(n))}),d(1),s()}if(r&2){let e=t.$implicit,i=a(4);u("ngClass",b(2,Ge,i.selectedCategory===e)),l(),h(" ",e," ")}}function ot(r,t){if(r&1&&v(0,rt,2,4,"li",63),r&2){let e=a(3);u("ngForOf",e.categoryEnum)}}function st(r,t){if(r&1&&(o(0,"div",28)(1,"ul"),E(2,ot,1,1,"li",61,O),s()()),r&2){let e=a(2);l(2),R(e.categoryEnum)}}function at(r,t){if(r&1){let e=g();o(0,"div",35)(1,"span"),d(2),s(),o(3,"i",64),_("click",function(){let n=p(e).$implicit,c=a(2);return m(c.onRemoveTagClick(n))})("keyup",function(){let n=p(e).$implicit,c=a(2);return m(c.onRemoveTagClick(n))}),s()()}if(r&2){let e=t.$implicit;l(2),F(e)}}function ct(r,t){if(r&1){let e=g();o(0,"form",2),_("submit",function(){p(e);let n=a();return m(n.onSubmit())}),o(1,"div",3),f(2,"input",4),o(3,"label",5),d(4,"Recept neve:"),s()(),o(5,"div",6),f(6,"textarea",7),o(7,"label",8),d(8,"Le\xEDr\xE1s:"),s()(),o(9,"div",9)(10,"h3"),d(11,"Hozz\xE1val\xF3k"),s(),o(12,"div",10),E(13,Ye,7,2,"div",11,O),s(),o(15,"div"),v(16,Ze,5,0,"div",12)(17,et,2,0,"button",13),s()(),o(18,"div",14)(19,"h3"),d(20,"Elk\xE9sz\xEDt\xE9si l\xE9p\xE9sek"),s(),o(21,"div",15),v(22,tt,8,2,"div",16),s(),o(23,"button",17),_("click",function(){p(e);let n=a();return m(n.onAddStepClick())}),d(24," + L\xE9p\xE9s hozz\xE1ad\xE1sa "),s()(),o(25,"div",6),f(26,"input",18),o(27,"label",19),d(28,"El\u0151k\xE9sz\xEDt\xE9si id\u0151 (perc):"),s()(),o(29,"div",6),f(30,"input",20),o(31,"label",21),d(32,"Adagok sz\xE1ma:"),s()(),o(33,"div",22)(34,"div",23)(35,"div",24),_("click",function(){p(e);let n=a();return m(n.isDifficultyDropdownOpen=!n.isDifficultyDropdownOpen)})("keyup",function(){p(e);let n=a();return m(n.isDifficultyDropdownOpen=!n.isDifficultyDropdownOpen)}),o(36,"div",25),d(37),s(),o(38,"div",26),f(39,"i",27),s()(),v(40,nt,4,0,"div",28),s(),o(41,"div",23)(42,"div",29),_("click",function(){p(e);let n=a();return m(n.isCategoryDropdownOpen=!n.isCategoryDropdownOpen)})("keyup",function(){p(e);let n=a();return m(n.isCategoryDropdownOpen=!n.isCategoryDropdownOpen)}),o(43,"div",25),d(44),s(),o(45,"div",26),f(46,"i",27),s()(),v(47,st,4,0,"div",28),s()(),o(48,"div",30)(49,"div",31)(50,"div",6)(51,"input",32),_("keyup.enter",function(){p(e);let n=a();return m(n.onAddTagClick())}),s(),o(52,"label",33),d(53,"C\xEDmk\xE9k:"),s()(),o(54,"div")(55,"button",17),_("click",function(){p(e);let n=a();return m(n.onAddTagClick())}),d(56,"+"),s()()(),o(57,"div",34),E(58,at,4,1,"div",35,O),s()(),o(60,"div",36)(61,"div",6)(62,"input",37),_("change",function(n){p(e);let c=a();return m(c.onFileSelected(n))}),s(),o(63,"label",38),d(64,"K\xE9p:"),s()()(),o(65,"div",39)(66,"div",40)(67,"button",41),d(68),s()()()()}if(r&2){let e=a();u("formGroup",e.receipeForm),l(6),u("rows",4),l(7),R(e.sections.controls),l(3),x(e.showNewSectionInput?16:-1),l(),x(e.showNewSectionInput?-1:17),l(5),u("ngForOf",e.steps.controls),l(13),u("ngClass",b(15,ze,e.isDifficultyDropdownOpen)),l(2),h(" ",e.selectedDifficulty?e.selectedDifficulty:"Neh\xE9zs\xE9g"," "),l(2),u("ngClass",A(17,Pe,e.isDifficultyDropdownOpen,!e.isDifficultyDropdownOpen)),l(),x(e.isDifficultyDropdownOpen?40:-1),l(2),u("ngClass",b(20,ze,e.isCategoryDropdownOpen)),l(2),h(" ",e.selectedCategory?e.selectedCategory:"Kateg\xF3ria"," "),l(2),u("ngClass",A(22,Pe,e.isCategoryDropdownOpen,!e.isCategoryDropdownOpen)),l(),x(e.isCategoryDropdownOpen?47:-1),l(11),R(e.tagsList()),l(9),u("disabled",e.receipeForm.invalid),l(),h(" ",e.existingReceipt()?"Recept m\xF3dos\xEDt\xE1sa":"Recept l\xE9trehoz\xE1sa"," ")}}var $=class r{user=k.required();isCreateReceipt=k(!1);existingReceipt=k(null);isExistingRecipe=fe(()=>!!this.existingReceipt());createEvent=new N;updateEvent=new N;closeEvent=new N;receipeForm;isDifficultyDropdownOpen=!1;isCategoryDropdownOpen=!1;selectedDifficulty="";selectedCategory="";unitEnum=Object.values(Me);difficultyEnum=Object.values(Ne);categoryEnum=Object.values($e);newTag="";ingredientsList=[];showNewSectionInput=!1;tagsList=y([]);fb=w(be);toastr=w(D);get steps(){return this.receipeForm.get("steps")}get categories(){return this.receipeForm.get("category")}get sections(){return this.receipeForm.get("ingredients")}ingredients(t){return this.sections.at(t).get("ingredients")}ngOnInit(){this.initForm()}initForm(){this.existingReceipt()?this.receipeForm=this.fb.group({receiptName:[this.existingReceipt()?.name,C.required],description:[this.existingReceipt()?.description||"",C.required],ingredients:this.fb.array(this.createIngredientsArray(this.existingReceipt().ingredients)),steps:this.fb.array(this.createStepsArray(this.existingReceipt().steps)),prepTime:[this.existingReceipt()?.prepTime,[C.required,C.min(0)]],servings:[this.existingReceipt()?.servings,[C.required,C.min(1)]],difficulty:[this.existingReceipt()?.difficulty,C.required],category:[this.existingReceipt()?.category,C.required],tags:[this.createTagsArray(this.existingReceipt()?.tags||[])],newTag:[""],imageUrl:[this.existingReceipt()?.imageUrl],sectionName:[""]}):this.receipeForm=this.fb.group({receiptName:["",C.required],description:["",C.required],ingredients:this.fb.array([]),steps:this.fb.array([]),prepTime:["",[C.required,C.min(0)]],servings:["",[C.required,C.min(1)]],difficulty:["",C.required],category:["",C.required],tags:[[]],newTag:[""],imageUrl:[""],sectionName:[""]}),console.log(this.receipeForm)}createIngredientsArray(t){return t.map(e=>this.fb.group({sectionName:[e.sectionName,C.required],ingredients:this.fb.array(e.ingredients.map(i=>this.fb.group({name:[i.name,C.required],amount:[i.amount,[C.required,C.min(0)]],unit:[i.unit,C.required],optional:[i.optional||!1]})))}))}createStepsArray(t){return t.map(e=>this.fb.group({stepDescription:[e]}))}createTagsArray(t){t.map(e=>this.tagsList().push(e))}onSubmit(){let t=this.receipeForm.getRawValue();console.log();let e=t.steps.map(c=>c.stepDescription),n={id:this.existingReceipt()?this.existingReceipt().id:Ae.length+1,name:t.receiptName,description:t.description,ingredients:t.ingredients,steps:e,prepTime:t.prepTime,servings:t.servings,difficulty:t.difficulty,category:t.category,tags:t.tags,imageUrl:t.imageUrl||"",createdAt:new Date().toISOString(),createdById:+this.user().userId,reviews:null,averageRating:0,likes:0,saves:0};console.log("data",n),this.existingReceipt()?this.updateEvent.emit(n):this.createEvent.emit(n),this.onClose()}addSection(){console.log(this.receipeForm.get("sectionName")),this.showNewSectionInput=!1;let t=this.fb.group({sectionName:this.receipeForm.get("sectionName")?.value,ingredients:this.fb.array([])});this.sections.push(t),this.receipeForm.get("sectionName")?.setValue("")}addIngredient(t){let e=this.fb.group({name:["",C.required],amount:[0,[C.required,C.min(0)]],unit:["g",C.required]});this.ingredients(t).push(e)}removeSection(t){this.sections.removeAt(t)}removeIngredient(t,e){this.ingredients(t).removeAt(e)}onAddStepClick(){let t=new z({stepDescription:new S("",C.required)});this.steps.push(t)}removeStep(t){this.steps.removeAt(t)}onAddTagClick(){let t=this.receipeForm.get("newTag")?.value?.trim()??"";console.log(this.tagsList().length),t&&this.tagsList().length<10?(this.tagsList.set([...this.tagsList(),t]),this.receipeForm.get("tags")?.setValue([...this.tagsList()]),this.receipeForm.get("newTag")?.setValue("")):this.toastr.warning("Maximum 10 c\xEDmk\xE9t adhat hozz\xE1 egy recepthez!")}onRemoveTagClick(t){let e=this.tagsList().findIndex(i=>i===t);if(e!==-1){let i=[...this.tagsList()];i.splice(e,1),this.tagsList.set(i),this.receipeForm.get("tags")?.setValue(this.tagsList())}}selectCategory(t){this.selectedCategory=t,this.receipeForm.get("category")?.setValue(t),this.isCategoryDropdownOpen=!1}selectDifficulty(t){this.selectedDifficulty=t,this.receipeForm.get("difficulty")?.setValue(t),this.isDifficultyDropdownOpen=!1}onClose(){this.closeEvent.emit(),this.receipeForm.reset(),this.tagsList.set([]),this.steps.clear()}onFileSelected(t){let e=t.target.files[0];if(e){let i=new FileReader;i.onload=n=>{this.receipeForm.patchValue({imageUrl:n.target.result})},i.readAsDataURL(e)}}handleClick(t){let e=t.target;e.closest(".custom-select-input.dif")||e.closest(".custom-dropdown-menu")||(this.isDifficultyDropdownOpen=!1),e.closest(".custom-select-input.cat")||e.closest(".custom-dropdown-menu")||(this.isCategoryDropdownOpen=!1)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=V({type:r,selectors:[["app-recipe-create"]],hostBindings:function(e,i){e&1&&_("click",function(c){return i.handleClick(c)},!1,le)},inputs:{user:[1,"user"],isCreateReceipt:[1,"isCreateReceipt"],existingReceipt:[1,"existingReceipt"]},outputs:{createEvent:"createEvent",updateEvent:"updateEvent",closeEvent:"closeEvent"},decls:3,vars:7,consts:[["createReceipt",""],[3,"submitEvent","closeEvent","isModalVisible","size","header","footerButtonLabel","isFooterCancelVisible","formGroup","formTemplate"],[1,"receipt-form","h-100",3,"submit","formGroup"],[1,"form-group","align-self-end"],["id","receiptName","formControlName","receiptName","type","text","placeholder"," "],["for","receiptName"],[1,"form-group"],["id","description","formControlName","description","placeholder"," ",3,"rows"],["for","description"],[1,"ingredients-container"],["formArrayName","ingredients",1,"ingredients"],[3,"formGroupName"],[1,"form-group","col-4"],["type","button"],[1,"steps-container"],["formArrayName","steps",1,"steps"],["class","step-row",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"base-button",3,"click"],["id","prepTime","formControlName","prepTime","type","number","placeholder"," "],["for","prepTime"],["id","servings","formControlName","servings","type","number","placeholder"," "],["for","servings"],[1,"custom-select-group"],[1,"custom-select","ps-3"],["tabindex","0",1,"custom-select-input","dif",3,"click","keyup","ngClass"],[1,"text-container"],[1,"icon-container"],[1,"fa-solid",3,"ngClass"],[1,"custom-dropdown-menu"],["tabindex","0",1,"custom-select-input","cat",3,"click","keyup","ngClass"],[1,"tags-container"],[1,"container"],["id","tagsInput","type","text","formControlName","newTag","placeholder"," ",3,"keyup.enter"],["for","tagsInput"],[1,"tags-list"],[1,"tag"],[1,"fileUpload"],["id","imageUrl","formControlName","imageUrl","type","file",3,"change"],["for","imageUrl"],[1,"submitButton"],[1,"footer","w-100"],["type","submit",1,"base-button","submit",3,"disabled"],[1,"d-flex","align-items-center"],["formArrayName","ingredients",1,"mb-3"],["type","button",3,"click"],[1,"section-header","form-group","col-6"],["formControlName","sectionName"],["for","sectionName"],["tabindex","0",1,"fa-solid","fa-trash",3,"click","keyup"],[1,"ingredient-row","form-group"],["formControlName","name"],["for","name"],["formControlName","amount","type","number"],["for","amount"],["formControlName","unit"],[3,"value"],["tabindex","0",1,"fa-solid","fa-circle-check","ms-4",3,"click","keyup"],[1,"step-row",3,"formGroupName"],[1,"step-index"],["formControlName","stepDescription","type","text","placeholder"," "],["for","stepDescription"],["tabindex","0",3,"ngClass"],["tabindex","0",3,"click","keyup","ngClass"],["tabindex","0",3,"ngClass","click","keyup",4,"ngFor","ngForOf"],["tabindex","0",1,"fa-solid","fa-circle-xmark",3,"click","keyup"]],template:function(e,i){if(e&1){let n=g();o(0,"app-modal",1),_("submitEvent",function(){return p(n),m(i.onSubmit())})("closeEvent",function(){return p(n),m(i.onClose())}),s(),v(1,ct,69,25,"ng-template",null,0,_e)}if(e&2){let n=ue(2);u("isModalVisible",i.isCreateReceipt()||i.isExistingRecipe())("size","large")("header","Recept l\xE9trehoz\xE1sa")("footerButtonLabel","L\xE9trehoz\xE1s")("isFooterCancelVisible",!0)("formGroup",i.receipeForm)("formTemplate",n)}},dependencies:[T,G,Ce,M,Q,Ee,Re,H,we,ke,K,J,I,W,X,he,ye,Te],encapsulation:2})};var Be=(r,t)=>t.name,je=(r,t)=>t.id,He=r=>({active:r}),lt=(r,t)=>({"fa-sort-up":r,"fa-sort-down":t}),pt=r=>({"active-item":r});function mt(r,t){if(r&1){let e=g();o(0,"li",15),_("click",function(){let n=p(e).$implicit,c=a(2);return m(c.onDropdownMenuItemClick(n.name))})("keyup",function(){let n=p(e).$implicit,c=a(2);return m(c.onDropdownMenuItemClick(n.name))}),d(1),s()}if(r&2){let e=t.$implicit,i=a(2);u("ngClass",b(2,pt,e.name===i.activeMenu())),l(),h(" ",e.label," ")}}function dt(r,t){if(r&1&&(o(0,"div",13)(1,"ul"),E(2,mt,2,4,"li",14,Be),s()()),r&2){let e=a();l(2),R(e.menuItems)}}function ut(r,t){if(r&1){let e=g();o(0,"button",16),_("click",function(){let n=p(e).$implicit,c=a();return m(c.onMenuItemClick(n.name))}),d(1),s()}if(r&2){let e=t.$implicit,i=a();u("ngClass",b(2,He,e.name===i.activeMenu())),l(),h(" ",e.label," ")}}function _t(r,t){if(r&1){let e=g();o(0,"div",10)(1,"button",17),_("click",function(){p(e);let n=a();return m(n.onNavigateBackSavedReceipts())}),d(2,"Vissza"),s()()}}function ft(r,t){if(r&1){let e=g();o(0,"div",20)(1,"div",21),_("click",function(){p(e);let n=a(2);return m(n.showCollections())})("keyup",function(){p(e);let n=a(2);return m(n.showCollections())}),f(2,"i",22),o(3,"p"),d(4,"Gy\u0171jtem\xE9nyek"),s()()()}}function Ct(r,t){if(r&1){let e=g();o(0,"div",21),_("click",function(){let n=p(e).$implicit,c=a(3);return m(c.openCollection(n))})("keyup",function(){let n=p(e).$implicit,c=a(3);return m(c.openCollection(n))}),f(1,"i",22),o(2,"p"),d(3),s()()}if(r&2){let e=t.$implicit;l(3),F(e.name)}}function gt(r,t){if(r&1&&(o(0,"div",23),E(1,Ct,4,1,"div",24,je),s()),r&2){let e=a(2);l(),R(e.collectionsList())}}function vt(r,t){if(r&1&&v(0,ft,5,0,"div",18)(1,gt,3,0,"div",19),r&2){let e=a();u("ngIf",e.savedViewMode()==="saved"),l(),u("ngIf",e.savedViewMode()==="collections")}}function xt(r,t){if(r&1){let e=g();o(0,"i",31),_("click",function(){p(e);let n=a().$implicit,c=a(2);return c.editModalOpen=!0,m(c.editedRecipe=n)})("keyup",function(){p(e);let n=a().$implicit,c=a(2);return c.editModalOpen=!0,m(c.editedRecipe=n)}),s()}}function wt(r,t){if(r&1){let e=g();o(0,"div",25)(1,"div",26),_("click",function(){let n=p(e).$implicit,c=a(2);return m(c.navigateToReceipt(n))})("keyup",function(){let n=p(e).$implicit,c=a(2);return m(c.navigateToReceipt(n))}),f(2,"img",27),s(),o(3,"div",28),v(4,xt,1,0,"i",29),o(5,"p",30),_("click",function(){let n=p(e).$implicit,c=a(2);return m(c.navigateToReceipt(n))})("keyup",function(){let n=p(e).$implicit,c=a(2);return m(c.navigateToReceipt(n))}),d(6),s()()()}if(r&2){let e=t.$implicit,i=a(2);l(2),de("alt",e.name),u("src",e.imageUrl?e.imageUrl:i.blankFood,q),l(2),x(i.activeMenu()==="own"&&i.isOwnPage()?4:-1),l(2),h(" ",e.name," ")}}function ht(r,t){if(r&1&&E(0,wt,7,4,"div",25,je),r&2){let e=a();R(e.receiptList())}}function yt(r,t){if(r&1){let e=g();o(0,"app-recipe-create",32),_("updateEvent",function(n){p(e);let c=a();return m(c.editReceipt(n))})("closeEvent",function(){p(e);let n=a();return m(n.editModalOpen=!1)}),s()}if(r&2){let e=a();u("user",e.user())("existingReceipt",e.editedRecipe)}}var Z=class r{user=k.required();isOwnPage=k.required();isNewRecipe=k();activeMenu=y("own");receiptList=y([]);collectionsList=y([]);savedViewMode=y("saved");isDropdownOpen=!1;selectedMenuItem=new U("Saj\xE1t receptek","own");menuItems=[new U("Saj\xE1t receptek","own"),new U("Kedvenc receptek","favorite"),new U("Mentett receptek","saved")];editModalOpen=!1;editedRecipe=null;blankFood=Oe;receiptService=w(Y);router=w(j);toastr=w(D);ngOnInit(){this.getReceiptsById(this.user().receipts.created)}ngOnChanges(t){t.user&&t.user.currentValue&&this.onMenuItemClick("own")}getReceiptsById(t){this.receiptService.getReceiptsByIds(t).pipe(L(1)).subscribe({next:e=>{this.receiptList.set(e)}})}showCollections(){this.savedViewMode.set("collections"),this.collectionsList.set(this.user().receipts.collections)}openCollection(t){this.getReceiptsById(this.user().receipts.collections[t.id].receipts),this.savedViewMode.set("collection-contents"),this.getReceiptsById(t.receipts)}editReceipt(t){this.receiptService.updateReceipt(t).pipe(L(1)).subscribe({next:e=>{if(!e)return;let i=[...this.receiptList()],n=i.findIndex(c=>c.id===e.id);n!==-1&&(i[n]=re({},e),this.receiptList.set(i),this.activeMenu()==="own"&&(this.user().receipts.created=i.map(c=>c.id))),this.toastr.success("Recept sikeresen friss\xEDtve!"),this.editModalOpen=!1},error:()=>{this.toastr.error("Hiba t\xF6rt\xE9nt a recept friss\xEDt\xE9sekor!")}})}toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}onDropdownMenuItemClick(t){this.selectedMenuItem=this.menuItems.find(e=>e.name===t)||new U("",""),this.onMenuItemClick(t),this.isDropdownOpen=!1}onMenuItemClick(t){switch(t){case"own":this.activeMenu.set("own"),this.getReceiptsById(this.user().receipts.created);break;case"favorite":this.activeMenu.set("favorite"),this.getReceiptsById(this.user().receipts.liked);break;case"saved":this.activeMenu.set("saved"),this.savedViewMode.set("saved"),this.getReceiptsById(this.user().receipts.saved);break}}navigateToReceipt(t){this.router.navigate(["/recept",Fe(t.name)],{state:{id:t.id,direction:`/profil/${this.user()?.username}`}})}onNavigateBackSavedReceipts(){this.savedViewMode.set(this.savedViewMode()==="collection-contents"?"collections":"saved"),this.savedViewMode()==="saved"&&this.onMenuItemClick("saved")}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=V({type:r,selectors:[["app-user-receipts"]],inputs:{user:[1,"user"],isOwnPage:[1,"isOwnPage"],isNewRecipe:[1,"isNewRecipe"]},features:[P],decls:17,vars:13,consts:[[1,"menu"],[1,"menu-dropdown"],[1,"custom-select"],["tabindex","0",1,"custom-select-input",3,"click","keyup.enter","ngClass"],[1,"text-container"],[1,"icon-container"],[1,"fa-solid",3,"ngClass"],["class","custom-dropdown-menu recipe-menu",4,"ngIf"],[1,"menu-buttons"],["type","button",3,"ngClass"],[1,"back-button"],[1,"receipts"],[3,"user","existingReceipt"],[1,"custom-dropdown-menu","recipe-menu"],["tabindex","0",3,"ngClass"],["tabindex","0",3,"click","keyup","ngClass"],["type","button",3,"click","ngClass"],["type","button",3,"click"],["class","folders mt-4",4,"ngIf"],["class","folders",4,"ngIf"],[1,"folders","mt-4"],["tabindex","0",1,"folder-card",3,"click","keyup"],[1,"fa-regular","fa-folder"],[1,"folders"],["tabindex","0",1,"folder-card"],[1,"receipt-card"],["tabindex","0",1,"img-container",3,"click","keyup"],[1,"fixed-img",3,"src","alt"],[1,"name-container"],["tabindex","0",1,"fa-solid","fa-pen-to-square"],["tabindex","0",1,"mt-2",3,"click","keyup"],["tabindex","0",1,"fa-solid","fa-pen-to-square",3,"click","keyup"],[3,"updateEvent","closeEvent","user","existingReceipt"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),_("click",function(){return i.toggleDropdown()})("keyup.enter",function(){return i.toggleDropdown()}),o(4,"div",4),d(5),s(),o(6,"div",5),f(7,"i",6),s(),v(8,dt,4,0,"div",7),s()()(),o(9,"div",8),E(10,ut,2,4,"button",9,Be),s()(),v(12,_t,3,0,"div",10),o(13,"div",11),v(14,vt,2,2)(15,ht,2,0),s(),v(16,yt,1,2,"app-recipe-create",12)),e&2&&(l(3),u("ngClass",b(8,He,i.isDropdownOpen)),l(2),h(" ",i.selectedMenuItem?i.selectedMenuItem.label:"Men\xFC kiv\xE1laszt\xE1sa"," "),l(2),u("ngClass",A(10,lt,i.isDropdownOpen,!i.isDropdownOpen)),l(),u("ngIf",i.isDropdownOpen),l(2),R(i.menuItems),l(2),x(i.savedViewMode()!=="saved"&&i.activeMenu()==="saved"?12:-1),l(2),x(i.activeMenu()==="saved"?14:-1),l(),x(i.savedViewMode()!=="collections"||i.activeMenu()!=="saved"?15:-1),l(),x(i.editModalOpen?16:-1))},dependencies:[T,G,B,I,$],encapsulation:2})};function kt(r,t){if(r&1){let e=g();o(0,"button",11),_("click",function(){p(e);let n=a(3);return m(n.isChangeData.set(!0))}),d(1," Adatok m\xF3dos\xEDt\xE1sa "),s()}}function Et(r,t){if(r&1&&v(0,kt,2,0,"button",13),r&2){let e=a(2);u("ngIf",!e.isChangeData())}}function Rt(r,t){if(r&1){let e=g();o(0,"button",11),_("click",function(){p(e);let n=a(3);return m(n.isChangeData.set(!1))}),d(1,"M\xE9gse"),s()}}function bt(r,t){if(r&1&&v(0,Rt,2,0,"button",13),r&2){let e=a(2);u("ngIf",e.isChangeData())}}function St(r,t){if(r&1&&(pe(0),o(1,"form",14)(2,"div",15)(3,"div",16),f(4,"input",17),o(5,"label",18),d(6,"N\xE9v:"),s()(),o(7,"div",16),f(8,"input",19),o(9,"label",20),d(10,"Felhaszn\xE1l\xF3n\xE9v:"),s()(),o(11,"div",16),f(12,"input",21),o(13,"label",22),d(14,"E-mail c\xEDm:"),s()(),o(15,"div",23),f(16,"textarea",24),o(17,"label",25),d(18,"Magamr\xF3l:"),s()(),o(19,"div",10)(20,"button",26),d(21,"Ment\xE9s"),s()()()(),f(22,"hr"),o(23,"form",14)(24,"div",15)(25,"div",16),f(26,"input",27),o(27,"label",28),d(28,"Jelsz\xF3:"),s()(),o(29,"div",16),f(30,"input",29),o(31,"label",30),d(32,"Jelsz\xF3 meger\u0151s\xEDt\xE9se:"),s()()(),o(33,"div",10)(34,"button",26),d(35,"Ment\xE9s"),s()()(),me()),r&2){let e=a(2);l(),u("formGroup",e.userForm),l(15),u("cols",50)("rows",4),l(7),u("formGroup",e.passwordForm)}}function Vt(r,t){if(r&1){let e=g();o(0,"div",10)(1,"button",11),_("click",function(){p(e);let n=a();return m(n.isCreateReceipt.set(!0))}),d(2,"Recept \xEDr\xE1sa"),s()(),o(3,"div",10),v(4,Et,1,1,"button",12)(5,bt,1,1,"button",12),s(),v(6,St,36,4,"ng-container")}if(r&2){let e=a();l(4),x(e.isChangeData()?-1:4),l(),x(e.isChangeData()?5:-1),l(),x(e.isChangeData()?6:-1)}}function Ft(r,t){if(r&1){let e=g();o(0,"app-recipe-create",31),_("createEvent",function(n){p(e);let c=a();return c.createEvent.emit(n),m(c.isCreateReceipt.set(!1))})("closeEvent",function(){p(e);let n=a();return m(n.isCreateReceipt.set(!1))}),s()}if(r&2){let e=a();u("user",e.user())("isCreateReceipt",e.isCreateReceipt())}}var ee=class r{blankUser=Ue;user=k.required();userReceiptsLikes=k();customerOwnProfile=k();createEvent=new N;isChangeData=y(!1);isCreateReceipt=y(!1);userForm=new z({email:new S("",Ve()),username:new S(""),name:new S(""),description:new S("")});passwordForm=new z({password:new S("",C.required),passwordConfirm:new S("",[C.required,Se()])});toastr=w(D);ngOnInit(){this.customerOwnProfile()&&this.user()&&this.userForm.patchValue({email:this.user().email,username:this.user().username,name:this.user().name,description:this.user().description})}ngOnChanges(t){t.user&&this.user&&this.customerOwnProfile()&&this.userForm.patchValue({email:this.user().email,username:this.user().username,name:this.user().name,description:this.user().description})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=V({type:r,selectors:[["app-user-data"]],inputs:{user:[1,"user"],userReceiptsLikes:[1,"userReceiptsLikes"],customerOwnProfile:[1,"customerOwnProfile"]},outputs:{createEvent:"createEvent"},features:[P],decls:19,vars:9,consts:[[1,"photo"],[3,"src","alt"],[1,"description"],[1,"name"],[1,"numbers"],["tooltipStr","Receptek"],[1,"fa-solid","fa-receipt"],["tooltipStr","Kedvel\xE9sek a recepteken"],[1,"fa-solid","fa-heart","pe-2"],[3,"user","isCreateReceipt"],[1,"button-div"],["type","button",3,"click"],["type","button"],["type","button",3,"click",4,"ngIf"],[3,"formGroup"],[1,"form"],[1,"form-group","profile"],["type","text","id","name","formControlName","name","placeholder"," "],["for","name"],["type","text","id","username","formControlName","username","placeholder"," "],["for","username"],["type","email","id","email","formControlName","email","placeholder"," "],["for","email"],[1,"form-group","profile","mt-3"],["id","description","formControlName","description","placeholder"," ",3,"cols","rows"],["for","description"],["type","submit"],["type","password","id","password","formControlName","password","placeholder"," "],["for","password"],["type","password","id","passwordConfirm","formControlName","passwordConfirm","placeholder"," "],["for","passwordConfirm"],[3,"createEvent","closeEvent","user","isCreateReceipt"]],template:function(e,i){if(e&1&&(o(0,"div",0),f(1,"img",1),s(),o(2,"div",2)(3,"div",3),d(4),s(),o(5,"p"),d(6),s(),o(7,"div"),d(8),s(),o(9,"div",4)(10,"span",5),f(11,"i",6),d(12),s(),o(13,"span",7),f(14,"i",8),d(15),s()()(),f(16,"hr"),v(17,Vt,7,3)(18,Ft,1,2,"app-recipe-create",9)),e&2){let n;l(),u("src",(n=i.user().profilePictureUrl)!==null&&n!==void 0?n:i.blankUser,q)("alt",i.user().name),l(3),F(i.user().name),l(2),h("@",i.user().username,""),l(2),F(i.user().description),l(4),h(" ",i.user().receipts.created.length,""),l(3),h(" ",i.userReceiptsLikes(),""),l(2),x(i.customerOwnProfile()?17:-1),l(),x(i.isCreateReceipt()?18:-1)}},dependencies:[T,B,M,Q,H,K,J,I,W,X,Ie,$,Le],encapsulation:2})};var Ke=class r{userProfile=y(null);activeUser=y(null);userReceiptsLikes=y(0);customerOwnProfile=y(!1);destroyed$=new oe(1);userService=w(xe);authService=w(De);receiptService=w(Y);searchService=w(ve);route=w(ge);router=w(j);toastr=w(D);ngOnInit(){this.authService.user$.pipe(ce(this.destroyed$)).subscribe(t=>{this.activeUser.set(t),this.getUserData()})}getUserData(){this.route.paramMap.pipe(ae(t=>{let e=t.get("username");return this.userService.getUserByUsername(e)})).subscribe({next:t=>{t?(this.userProfile.set(t),this.customerOwnProfile.set(this.activeUser()?.userId===t.userId),this.getUserProfileAndReceipts(t)):this.router.navigate(["/receptek"])},error:t=>{console.error("Hiba t\xF6rt\xE9nt a felhaszn\xE1l\xF3 bet\xF6lt\xE9sekor",t),this.router.navigate(["/receptek"])}})}getUserProfileAndReceipts(t){t&&(t.receipts.created&&t.receipts.created.length>0?this.receiptService.getReceiptsByIds(t.receipts.created).pipe(L(1),se(e=>{let i=0;e.forEach(n=>{n&&(i+=n.likes||0)}),this.userReceiptsLikes.set(i)})).subscribe():this.userReceiptsLikes.set(0))}createReceipt(t){this.receiptService.createReceipt(t,this.userProfile()).subscribe({next:e=>{e&&(this.userProfile.set(e),this.toastr.success("Recept sikeresen l\xE9trehozva"))},error:()=>{this.toastr.error("Hiba t\xF6rt\xE9nt a recept l\xE9trehoz\xE1sakor!")}})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=V({type:r,selectors:[["app-user-profile"]],decls:5,vars:5,consts:[[1,"profile-container"],[1,"left","col-lg-3","col-md-4","col-sm-12"],[3,"createEvent","user","userReceiptsLikes","customerOwnProfile"],[1,"right","col-lg-9","col-md-8","col-sm-12"],[3,"user","isOwnPage"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"app-user-data",2),_("createEvent",function(c){return i.createReceipt(c)}),s()(),o(3,"div",3),f(4,"app-user-receipts",4),s()()),e&2&&(l(2),u("user",i.userProfile())("userReceiptsLikes",i.userReceiptsLikes())("customerOwnProfile",i.customerOwnProfile()),l(2),u("user",i.userProfile())("isOwnPage",i.customerOwnProfile()))},dependencies:[I,M,T,Z,ee],encapsulation:2})};export{Ke as UserProfileComponent};
